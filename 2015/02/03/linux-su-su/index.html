<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>su和su - | answerwa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="今天晚上突然发现，用普通用户通过putty登陆后，su到root，好多命令没有。。。而且切换到/root目录下source .bashrc和.bash_profile都没有用。1234567891011[zhaojc@centos ~]$ su口令：[root@centos zhaojc]# useraddbash: useradd: command not found[root@centos z">
<meta name="keywords" content="linux,su">
<meta property="og:type" content="article">
<meta property="og:title" content="su和su -">
<meta property="og:url" content="https://answerwa.github.io/2015/02/03/linux-su-su/index.html">
<meta property="og:site_name" content="answerwa">
<meta property="og:description" content="今天晚上突然发现，用普通用户通过putty登陆后，su到root，好多命令没有。。。而且切换到/root目录下source .bashrc和.bash_profile都没有用。1234567891011[zhaojc@centos ~]$ su口令：[root@centos zhaojc]# useraddbash: useradd: command not found[root@centos z">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2017-05-28T04:08:06.226Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="su和su -">
<meta name="twitter:description" content="今天晚上突然发现，用普通用户通过putty登陆后，su到root，好多命令没有。。。而且切换到/root目录下source .bashrc和.bash_profile都没有用。1234567891011[zhaojc@centos ~]$ su口令：[root@centos zhaojc]# useraddbash: useradd: command not found[root@centos z">
  
    <link rel="alternate" href="/atom.xml" title="answerwa" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">answerwa</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://answerwa.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-linux-su-su" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/02/03/linux-su-su/" class="article-date">
  <time datetime="2015-02-03T14:39:22.000Z" itemprop="datePublished">2015-02-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      su和su -
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天晚上突然发现，用普通用户通过putty登陆后，su到root，好多命令没有。。。而且切换到/root目录下source .bashrc和.bash_profile都没有用。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[zhaojc@centos ~]$ su</div><div class="line">口令：</div><div class="line">[root@centos zhaojc]<span class="meta"># useradd</span></div><div class="line">bash: useradd: command <span class="keyword">not</span> found</div><div class="line">[root@centos zhaojc]<span class="meta"># cd ~</span></div><div class="line">[root@centos ~]<span class="meta"># source .bashrc</span></div><div class="line">[root@centos ~]<span class="meta"># source .bash_profile</span></div><div class="line">[root@centos ~]<span class="meta"># useradd</span></div><div class="line">bash: useradd: command <span class="keyword">not</span> found</div><div class="line">[root@centos ~]<span class="meta"># echo $PATH</span></div><div class="line">/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/home/zhaojc/bin:/root/bin</div></pre></td></tr></table></figure></p>
<p>网上查了一下，才发现su是所谓的半切换，切换后，还是会保留原用户的环境(细心的话，会发现，su后，还在/home/zhaojc目录下)。至于为什么source /root下的两个文件也没用，我想可能是因为root相关环境配置接在了原用户的后面，比如PATH的话，/home/zhaojc/bin在/root/bin前面(个人猜想，没有依据)。<br>真正的切换用户应该是su -，这样会重新配置用户的环境。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">[zhaojc@centos ~]$ su -</div><div class="line">口令：</div><div class="line">[root@centos ~]<span class="meta"># groupadd</span></div><div class="line">Usage: groupadd [options] group</div><div class="line"></div><div class="line">Options:</div><div class="line">  -f, --force                   force <span class="built_in">exit</span> with success status <span class="keyword">if</span> the specified</div><div class="line">                                group already exists</div><div class="line">  -r,                       create system account</div><div class="line">  -g, --gid GID                 use GID <span class="keyword">for</span> the <span class="keyword">new</span> group</div><div class="line">  -h, --help                    display <span class="keyword">this</span> help message <span class="keyword">and</span> <span class="built_in">exit</span></div><div class="line">  -K, --key KEY=VALUE           overrides /etc/login.defs defaults</div><div class="line">  -o, --non-unique              allow create group with duplicate</div><div class="line">                                (non-unique) GID</div><div class="line"></div><div class="line">[root@centos ~]# echo $PATH</div><div class="line">/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</div></pre></td></tr></table></figure></p>
<p>可以看到，用su -切换后，PATH中没有了/home/zhaojc/bin，说明我之前的猜想，还是有点沾边的。`(<em>∩_∩</em>)′</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://answerwa.github.io/2015/02/03/linux-su-su/" data-id="cj6z4pofr000ddcu7a4yeprwg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/su/">su</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/03/04/something-20150304/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          《断舍离》读后感
        
      </div>
    </a>
  
  
    <a href="/2015/02/01/201501-annual-summary/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2015年1月终总结</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/cron/">cron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/">network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ntp/">ntp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pipe/">pipe</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/su/">su</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/总结/">总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/读后感/">读后感</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/cron/" style="font-size: 10px;">cron</a> <a href="/tags/linux/" style="font-size: 20px;">linux</a> <a href="/tags/network/" style="font-size: 10px;">network</a> <a href="/tags/ntp/" style="font-size: 10px;">ntp</a> <a href="/tags/pipe/" style="font-size: 10px;">pipe</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/su/" style="font-size: 10px;">su</a> <a href="/tags/总结/" style="font-size: 20px;">总结</a> <a href="/tags/读后感/" style="font-size: 15px;">读后感</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/08/30/README/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/08/30/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2017/08/30/记一次 system() 引起的端口抢占/">记一次 system() 引起的端口抢占</a>
          </li>
        
          <li>
            <a href="/2015/05/04/network/">网络知识记录</a>
          </li>
        
          <li>
            <a href="/2015/04/07/201503-annual-summary/">2015年3月终总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Zhao Junchi<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>